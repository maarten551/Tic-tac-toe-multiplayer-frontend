<!-- templates -->
<ng-template #createLobbyTemplate>
  <form (ngSubmit)="this.createNewLobby()" class="inline">
    <mat-form-field class="full-width">
      <input matInput placeholder="Name for new lobby" [(ngModel)]="this.newLobbyName" name="input-message">
    </mat-form-field>
    <button mat-raised-button color="primary" (click)="createLobbyPanel.close()" [disabled]="!this.newLobbyName.length">
      <mat-icon>create</mat-icon>
      Create new lobby
    </button>
  </form>
</ng-template>



<mat-card>
  <h2>Open lobbies</h2>
  <div> <!--  *ngIf="!lobbyService.waitingLobbies.length" -->
    <mat-accordion>
      <mat-expansion-panel #createLobbyPanel>
        <mat-expansion-panel-header>
          <mat-panel-title style="font-weight: bold">
            Create one
          </mat-panel-title>
        </mat-expansion-panel-header>

        <ng-container *ngTemplateOutlet="createLobbyTemplate"></ng-container>

      </mat-expansion-panel>

      <mat-expansion-panel *ngFor="let lobby of lobbyService.waitingLobbies">
        <mat-expansion-panel-header>
          <mat-panel-title>
            {{lobby.name}}
          </mat-panel-title>
          <mat-panel-description>
            Leader: {{lobby.leader.username}}
          </mat-panel-description>
        </mat-expansion-panel-header>

        <div>
          <p>Leader: {{lobby.leader.username}}</p>
          <p>Players:</p>
          <ul>
            <li *ngFor="let player of lobby.players">{{player.username}}</li>
          </ul>

          <div class="buttons">
            <ng-container *ngIf="this.isCurrentLeaderOfLobby(lobby)">
              <button mat-raised-button (click)="this.startGame(lobby)" color="primary">Start game</button>
            </ng-container>

            <ng-container *ngIf="this.lobbyService.selectedLobby == null">
              <button mat-raised-button (click)="this.joinLobby(lobby)" color="primary">Join lobby</button>
            </ng-container>

            <ng-container *ngIf="lobby == this.lobbyService.selectedLobby">
              <button mat-button (click)="this.leaveCurrentJoinedLobby()" color="warn">Leave lobby</button>
            </ng-container>
          </div>

        </div>

      </mat-expansion-panel>
    </mat-accordion>
  </div>


</mat-card>
